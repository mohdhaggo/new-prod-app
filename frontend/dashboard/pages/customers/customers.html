<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Management · Customers</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="customers.css">
</head>
<body>
<div class="container">
    <header class="app-header">
        <h1><i class="fas fa-users-cog"></i> Customers Management</h1>
        <p class="subtitle">Manage customers, vehicles, and service history</p>
    </header>

    <div class="main-section">
        <!-- SEARCH bar -->
        <div class="search-section">
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="smartSearchInput" class="smart-search-input" placeholder="Search by ID, name, mobile, vehicles, services..." autocomplete="off">
            </div>
            <div class="search-stats" id="searchStats">Showing all customers</div>
        </div>

        <!-- STATS bar -->
        <div class="stats-bar" id="statsBar">
            <div class="stat-item"><div class="stat-value" id="totalCustomers">0</div><div class="stat-label">Total Customers</div></div>
            <div class="stat-item"><div class="stat-value" id="totalVehiclesStat">0</div><div class="stat-label">Vehicles</div></div>
            <div class="stat-item"><div class="stat-value" id="totalServicesStat">0</div><div class="stat-label">Services</div></div>
        </div>

        <!-- section header with pagination & new customer -->
        <div class="section-header">
            <h2 class="section-title"><i class="fas fa-list"></i> Customers Records</h2>
            <div class="pagination-controls">
                <div class="records-per-page">
                    <label for="pageSizeSelect">Records per page:</label>
                    <select id="pageSizeSelect" class="page-size-select">
                        <option value="10">10</option><option value="20" selected>20</option><option value="50">50</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="newCustomerButton"><i class="fas fa-user-plus"></i> Add Customer</button>
            </div>
        </div>

        <!-- table wrapper with customers table -->
        <div class="table-wrapper">
            <table class="customers-table" id="customersTable">
                <thead><tr><th>Customer ID</th><th>Name</th><th>Mobile</th><th>Vehicles</th><th>Completed Services</th><th>Actions</th></tr></thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
        <!-- empty state -->
        <div class="empty-state" id="emptyState" style="display: none;"><div class="empty-icon"><i class="fas fa-user-slash"></i></div><div class="empty-text">No matching customers</div><div class="empty-subtext">Try adjusting search or add new customer</div></div>

        <!-- pagination -->
        <div class="pagination" id="paginationContainer">
            <button class="pagination-btn" id="prevPageBtn"><i class="fas fa-chevron-left"></i></button>
            <div class="pagination-numbers" id="pageNumbers"></div>
            <button class="pagination-btn" id="nextPageBtn"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>

    <footer class="app-footer"><p>Service Management System · Customer module ·</p></footer>
</div>

<!-- FULL SCREEN DETAILS -->
<div class="details-screen" id="detailsScreen">
    <div class="details-header">
        <h2><i class="fas fa-user-circle"></i> Customer Details – <span id="detailsCustomerId"></span></h2>
        <button class="btn-close-details" id="closeDetailsScreen"><i class="fas fa-times"></i> Close Details</button>
    </div>
    <div class="details-body" id="detailsBody"><div class="details-grid" id="detailsGrid"></div></div>
</div>

<!-- ADD CUSTOMER MODAL with lead source -->
<div class="modal" id="addCustomerModal">
    <div class="modal-content">
        <div class="modal-header"><h3 class="modal-title"><i class="fas fa-user-plus"></i> Add New Customer</h3><button class="close-modal" id="closeModalBtn">&times;</button></div>
        <form id="addCustomerForm">
            <div class="form-group"><label>Customer Name <span style="color:red;">*</span></label><input type="text" id="newCustomerName" class="form-control" required></div>
            <div class="form-group"><label>Mobile Number <span style="color:red;">*</span></label><input type="tel" id="newCustomerMobile" class="form-control" required></div>
            <div class="form-group"><label>Email (optional)</label><input type="email" id="newCustomerEmail" class="form-control"></div>
            <div class="form-group"><label>Address (optional)</label><textarea id="newCustomerAddress" class="form-control" rows="2"></textarea></div>

            <!-- Heard of us from dropdown -->
            <div class="form-group"><label>Heard of us from</label>
                <select id="leadSourceSelect" class="form-control">
                    <option value="walk-in">Walk-in</option>
                    <option value="refer">Refer by person</option>
                    <option value="social">Social media</option>
                    <option value="other">Other</option>
                </select>
            </div>

            <!-- dynamic container for lead details -->
            <div id="leadSourceDynamicFields" style="margin-top: 5px;"></div>

            <div class="button-group">
                <button type="button" class="btn btn-success" id="saveCustomerBtn">Save Customer</button>
                <button type="button" class="btn btn-secondary" id="cancelModalBtn">Cancel</button>
            </div>
        </form>
    </div>
</div>

<!-- EDIT CUSTOMER MODAL with lead source -->
<div class="modal" id="editCustomerModal">
    <div class="modal-content">
        <div class="modal-header"><h3 class="modal-title"><i class="fas fa-edit"></i> Edit Customer</h3><button class="close-modal" id="closeEditModalBtn">&times;</button></div>
        <form id="editCustomerForm">
            <input type="hidden" id="editCustomerId">
            <div class="form-group"><label>Customer ID</label><input type="text" id="editCustomerIdDisplay" class="form-control" disabled></div>
            <div class="form-group"><label>Customer Name *</label><input type="text" id="editCustomerName" class="form-control" required></div>
            <div class="form-group"><label>Mobile Number *</label><input type="tel" id="editCustomerMobile" class="form-control" required></div>
            <div class="form-group"><label>Email</label><input type="email" id="editCustomerEmail" class="form-control"></div>
            <div class="form-group"><label>Address</label><textarea id="editCustomerAddress" class="form-control" rows="2"></textarea></div>

            <div class="form-group"><label>Heard of us from</label>
                <select id="editLeadSourceSelect" class="form-control">
                    <option value="walk-in">Walk-in</option>
                    <option value="refer">Refer by person</option>
                    <option value="social">Social media</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div id="editLeadSourceDynamic"></div>

            <div class="button-group">
                <button type="button" class="btn btn-primary" id="saveEditBtn">Save Changes</button>
                <button type="button" class="btn btn-secondary" id="cancelEditModalBtn">Cancel</button>
            </div>
        </form>
    </div>
</div>

<!-- ADD VEHICLE MODAL -->
<div class="modal" id="addVehicleModal">
    <div class="modal-content">
        <div class="modal-header"><h3 class="modal-title"><i class="fas fa-car"></i> Add Vehicle</h3><button class="close-modal" id="closeVehicleModalBtn">&times;</button></div>
        <form id="addVehicleForm">
            <input type="hidden" id="vehicleCustomerId">
            <div class="form-group"><label>Make *</label><input type="text" id="vehicleMake" class="form-control" required></div>
            <div class="form-group"><label>Model *</label><input type="text" id="vehicleModel" class="form-control" required></div>
            <div class="form-group"><label>Year *</label><input type="number" id="vehicleYear" class="form-control" min="1900" max="2030" required></div>
            <div class="form-group"><label>Type *</label><select id="vehicleType" class="form-control"><option value="">Select</option><option value="SUV">SUV</option><option value="Sedan">Sedan</option><option value="Hatchback">Hatchback</option></select></div>
            <div class="form-group"><label>Color *</label><input type="text" id="vehicleColor" class="form-control" required></div>
            <div class="form-group"><label>Plate Number *</label><input type="text" id="vehiclePlate" class="form-control" required></div>
            <div class="form-group"><label>VIN (optional)</label><input type="text" id="vehicleVin" maxlength="17" class="form-control"></div>
            <div class="button-group"><button type="button" class="btn btn-success" id="saveVehicleBtn">Save Vehicle</button><button type="button" class="btn btn-secondary" id="cancelVehicleModalBtn">Cancel</button></div>
        </form>
    </div>
</div>

<!-- ALERT POPUP -->
<div class="alert-popup" id="alertPopup">
    <div class="alert-content">
        <div class="alert-header success" id="alertHeader"><div class="alert-icon" id="alertIcon"></div><div class="alert-title" id="alertTitle"></div></div>
        <div class="alert-body"><div class="alert-message" id="alertMessage"></div><div class="alert-actions" id="alertActions"></div></div>
    </div>
</div>

<script src="customers.js"></script>
</body>
</html>